# Приложение A. Диаграммы использования (Use Case Diagrams)

> Диаграммы выполнены в нотации Mermaid. Для визуализации используйте любой Mermaid-рендерер.

---

## A.1 Общая диаграмма использования интернет-магазина

![alt text](/to/png/use-case-base.png)

```mermaid
graph LR
    subgraph Акторы
        Guest((Гость))
        Customer((Покупатель))
        Manager((Менеджер))
        Admin((Администратор))
    end

    subgraph "Интернет-магазин «ТехноСфера»"
        UC01[UC-01: Регистрация]
        UC02[UC-02: Авторизация]
        UC03[UC-03: Добавление товара в корзину]
        UC04[UC-04: Просмотр и редактирование корзины]
        UC05[UC-05: Оформление заказа]
        UC06[UC-06: Просмотр статуса заказа]
        UC07[UC-07: Отмена заказа]
        UC08[UC-08: Управление заказами]
        UC09[UC-09: Поиск товаров]
        UC10[UC-10: Просмотр каталога]
        UC11[UC-11: Просмотр карточки товара]
        UC12[UC-12: Оставить отзыв V2]
        UC13[UC-13: Управление товарами]
        UC14[UC-14: Управление пользователями]
        UC15[UC-15: Управление категориями]
        UC16[UC-16: Управление ПВЗ]
        UC17[UC-17: Управление промокодами V2]
        UC18[UC-18: Применение промокода V2]
        UC19[UC-19: Онлайн-оплата V2]
        UC20[UC-20: Программа лояльности V3]
        UC21[UC-21: Сравнение товаров V3]
    end

    Guest --> UC01
    Guest --> UC02
    Guest --> UC03
    Guest --> UC04
    Guest --> UC05
    Guest --> UC09
    Guest --> UC10
    Guest --> UC11

    Customer --> UC03
    Customer --> UC04
    Customer --> UC05
    Customer --> UC06
    Customer --> UC07
    Customer --> UC09
    Customer --> UC10
    Customer --> UC11
    Customer --> UC12
    Customer --> UC18
    Customer --> UC19
    Customer --> UC20
    Customer --> UC21

    Manager --> UC08
    Manager --> UC06

    Admin --> UC08
    Admin --> UC13
    Admin --> UC14
    Admin --> UC15
    Admin --> UC16
    Admin --> UC17
```

---

## A.2 Диаграмма использования: Процесс оформления заказа (детализация)

```mermaid
graph TB
    subgraph Акторы
        Guest((Гость))
        Customer((Покупатель))
        PayGateway((Платёжный шлюз))
    end

    subgraph "Процесс оформления заказа"
        UC_CART[Просмотр корзины]
        UC_CONTACT[Заполнение контактных данных]
        UC_DELIVERY[Выбор способа получения]
        UC_PICKUP[Выбор ПВЗ]
        UC_COURIER[Указание адреса доставки V2]
        UC_PAYMENT[Выбор способа оплаты]
        UC_PROMO[Применение промокода V2]
        UC_BONUS[Списание бонусных баллов V3]
        UC_CONFIRM[Подтверждение заказа]
        UC_ONLINE_PAY[Онлайн-оплата V2]
        UC_SUCCESS[Просмотр подтверждения]
    end

    Guest --> UC_CART
    Customer --> UC_CART
    UC_CART --> UC_CONTACT
    UC_CONTACT --> UC_DELIVERY

    UC_DELIVERY --> UC_PICKUP
    UC_DELIVERY --> UC_COURIER

    UC_PICKUP --> UC_PAYMENT
    UC_COURIER --> UC_PAYMENT

    UC_PAYMENT -.-> UC_PROMO
    UC_PAYMENT -.-> UC_BONUS
    UC_PAYMENT --> UC_CONFIRM

    UC_CONFIRM --> UC_SUCCESS
    UC_CONFIRM -.-> UC_ONLINE_PAY
    UC_ONLINE_PAY --> UC_SUCCESS

    PayGateway --> UC_ONLINE_PAY

    style UC_COURIER fill:#ffffcc
    style UC_PROMO fill:#ffffcc
    style UC_ONLINE_PAY fill:#ffffcc
    style UC_BONUS fill:#e6ffe6
```

**Легенда:**
- Белый - V1
- Жёлтый - V2
- Зелёный - V3

---

## A.3 Диаграмма использования: Управление заказами (Менеджер / Администратор)

```mermaid
graph LR
    subgraph Акторы
        Manager((Менеджер))
        Admin((Администратор))
    end

    subgraph "Управление заказами"
        UC_VIEW_LIST[Просмотр списка заказов]
        UC_FILTER[Фильтрация заказов]
        UC_VIEW_DETAIL[Просмотр деталей заказа]
        UC_CHANGE_STATUS[Изменение статуса заказа]
        UC_CANCEL_ORDER[Отмена заказа]
        UC_REFUND[Возврат средств V2]
        UC_EXPORT[Экспорт в CSV/Excel V3]
    end

    Manager --> UC_VIEW_LIST
    Manager --> UC_FILTER
    Manager --> UC_VIEW_DETAIL
    Manager --> UC_CHANGE_STATUS
    Manager --> UC_CANCEL_ORDER
    Manager --> UC_REFUND

    Admin --> UC_VIEW_LIST
    Admin --> UC_FILTER
    Admin --> UC_VIEW_DETAIL
    Admin --> UC_CHANGE_STATUS
    Admin --> UC_CANCEL_ORDER
    Admin --> UC_REFUND
    Admin --> UC_EXPORT

    UC_CHANGE_STATUS -.-> UC_REFUND
```

---

## A.4 Диаграмма использования: Каталог и поиск

```mermaid
graph LR
    subgraph Акторы
        User((Гость / Покупатель))
    end

    subgraph "Каталог и поиск"
        UC_BROWSE[Просмотр каталога по категориям]
        UC_SEARCH[Поиск товаров по запросу]
        UC_FILTER_CAT[Фильтрация по характеристикам]
        UC_SORT[Сортировка результатов]
        UC_VIEW_PRODUCT[Просмотр карточки товара]
        UC_ADD_CART[Добавление в корзину]
        UC_COMPARE[Добавление к сравнению V3]
        UC_WISHLIST[Добавление в избранное V3]
        UC_REVIEW_READ[Просмотр отзывов V2]
    end

    User --> UC_BROWSE
    User --> UC_SEARCH
    UC_BROWSE --> UC_FILTER_CAT
    UC_BROWSE --> UC_SORT
    UC_SEARCH --> UC_FILTER_CAT
    UC_SEARCH --> UC_SORT
    UC_FILTER_CAT --> UC_VIEW_PRODUCT
    UC_SORT --> UC_VIEW_PRODUCT
    UC_VIEW_PRODUCT --> UC_ADD_CART
    UC_VIEW_PRODUCT --> UC_COMPARE
    UC_VIEW_PRODUCT --> UC_WISHLIST
    UC_VIEW_PRODUCT --> UC_REVIEW_READ
```

---

## A.5 Описание прецедентов (таблица)

| ID | Название | Актор(ы) | Версия | Краткое описание |
|----|---------|----------|--------|-----------------|
| UC-01 | Регистрация | Гость | V1 | Создание учётной записи с email, паролем и контактными данными |
| UC-02 | Авторизация | Гость | V1 | Вход в систему по email + пароль, получение JWT-токенов |
| UC-03 | Добавление товара в корзину | Гость, Покупатель | V1 | Добавление товара (SKU) в корзину с проверкой остатка |
| UC-04 | Просмотр и редактирование корзины | Гость, Покупатель | V1 | Изменение количества, удаление, пересчёт суммы |
| UC-05 | Оформление заказа | Гость, Покупатель | V1 | Четырёхшаговый процесс: контакты → получение → оплата → подтверждение |
| UC-06 | Просмотр статуса заказа | Покупатель, Менеджер | V1 | Просмотр текущего статуса и истории изменений заказа |
| UC-07 | Отмена заказа | Покупатель, Менеджер | V1 | Отмена заказа с указанием причины. Снятие резерва. Возврат средств (V2) |
| UC-08 | Управление заказами | Менеджер, Администратор | V1 | Просмотр списка, фильтрация, смена статусов, управление заказами |
| UC-09 | Поиск товаров | Гость, Покупатель | V1 | Полнотекстовый поиск по каталогу с подсказками и фильтрацией |
| UC-10 | Просмотр каталога | Гость, Покупатель | V1 | Навигация по дереву категорий с фильтрами и сортировкой |
| UC-11 | Просмотр карточки товара | Гость, Покупатель | V1 | Детальная информация о товаре: фото, описание, характеристики, цена, наличие |
| UC-12 | Оставить отзыв | Покупатель | V2 | Оценка 1-5 + текст. Только для купленных товаров. Модерация |
| UC-13 | Управление товарами | Администратор | V1 | CRUD для товаров: создание, редактирование, удаление, управление остатками |
| UC-14 | Управление пользователями | Администратор | V1 | Просмотр, блокировка, смена ролей |
| UC-15 | Управление категориями | Администратор | V1 | CRUD для дерева категорий |
| UC-16 | Управление ПВЗ | Администратор | V1 | CRUD для пунктов выдачи |
| UC-17 | Управление промокодами | Администратор | V2 | CRUD для промокодов: тип скидки, лимиты, период действия |
| UC-18 | Применение промокода | Покупатель | V2 | Ввод промокода при оформлении, валидация, расчёт скидки |
| UC-19 | Онлайн-оплата | Покупатель | V2 | Оплата банковской картой или через СБП с редиректом на платёжный шлюз |
| UC-20 | Программа лояльности | Покупатель | V3 | Начисление и списание бонусных баллов |
| UC-21 | Сравнение товаров | Гость, Покупатель | V3 | Добавление до 4 товаров одной категории в таблицу сравнения |
